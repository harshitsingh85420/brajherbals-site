<!doctype html><html><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Shop — Braj Herbals</title>
<style>
  :root{--bord:#e5e5e5;--brand:#0a7;--fg:#111}*{box-sizing:border-box}
  body{margin:0;font-family:system-ui,Arial;color:var(--fg)}
  header{padding:12px 16px;border-bottom:1px solid var(--bord);display:flex;gap:12px;align-items:center}
  .bar{display:flex;gap:8px;align-items:center;padding:12px;border-bottom:1px solid var(--bord)}
  .bar input,.bar select{padding:10px;border:1px solid var(--bord);border-radius:8px}
  .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:16px;padding:16px}
  .card{border:1px solid var(--bord);border-radius:12px;padding:12px;background:#fff}
  .card img{width:100%;height:180px;object-fit:cover;border-radius:8px}
  .btn{padding:10px 14px;border-radius:8px;border:1px solid var(--brand);background:var(--brand);color:#fff;cursor:pointer}
</style>
</head><body>
<header>
  <a href="/">Home</a>
  <a href="/cart.html">Cart (<span id="cartCount">0</span>)</a>
  <a href="/admin/">Admin</a>
</header>

<div class="bar">
  <input id="q" placeholder="Search…" style="flex:1">
  <select id="cat">
    <option value="">All categories</option>
    <option value="Candles">Candles</option>
    <option value="Gulal">Gulal</option>
  </select>
  <select id="sort">
    <option value="newest">Newest</option>
    <option value="price_asc">Price ↑</option>
    <option value="price_desc">Price ↓</option>
    <option value="title_asc">Title A–Z</option>
    <option value="title_desc">Title Z–A</option>
  </select>
  <button class="btn" onclick="list()">Apply</button>
</div>

<main id="list" class="grid"></main>

<script src="/js/cart.js"></script>
<script>
async function list(){
  const u = new URL('/api/products', location.origin);
  const q = document.getElementById('q').value.trim();
  const cat = document.getElementById('cat').value;
  const sort = document.getElementById('sort').value;
  if(q) u.searchParams.set('q', q);
  if(cat) u.searchParams.set('category', cat);
  if(sort) u.searchParams.set('sort', sort);

  const r = await fetch(u);
  const items = await r.json();

  const el = document.getElementById('list'); el.innerHTML='';
  items.forEach(p=>{
    const card=document.createElement('div'); card.className='card';
    card.innerHTML = `
      <img src="${p.image||''}" alt="${p.title||''}">
      <h3>${p.title||''}</h3>
      <p><b>₹${p.price||''}</b></p>
      <button class="btn">Add to cart</button>`;
    card.querySelector('button').onclick = ()=> { addToCart(p); alert('Added'); };
    el.appendChild(card);
  });
  updateCartBadge();
}
list();
</script>
</body></html>
